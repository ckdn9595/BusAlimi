<?xml version="1.0" encoding="UTF-8"?>
	<!DOCTYPE mapper
		PUBLIC  "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
		
<mapper namespace="mSQL">
	<!-- 요안에다가  작업-->
	<select id="loginCnt" resultType="int" parameterType="mVO">
		SELECT 
		    COUNT(*) cnt 
		FROM 
		    member 
		WHERE 
		    id = #{id}
		    AND pw = #{pw} 
		    AND isshow = 'Y' 
	</select>
	<select id="getMembInfo" resultType="mVO" parameterType="string">
		SELECT
			*
		FROM
			member
		WHERE
			id = #{id}
	</select>
	<select id="getMembAvt" resultType="aVO" parameterType="string">
		SELECT 
		    afile, dir, m.ano
		FROM 
		    avatar a, member m
		WHERE
			m.ano = a.ano 
		    AND id = #{id}
	</select>
	<select id="getAvt" resultType="aVO" >
		SELECT
		    ano, afile, dir, gen
		FROM
		    avatar
	</select>
	<select id="getQuest" resultType="fVO" >
		SELECT
			qno, quest
		FROM
			quest
		ORDER BY
			qno ASC
	</select>
	<select id="idCheck" resultType="int" parameterType="string">
		SELECT 
			count(*) cnt 
		FROM 
			member 
		WHERE 
			id = #{id}
			AND isshow = 'Y'
	</select>
	<insert id="addMemb" parameterType="mVO" >
		INSERT INTO
			member(mno, id, pw, name, mail, gen, ano)
		VALUES(
			(SELECT NVL(MAX(mno) + 1, 1001) FROM member),
		 #{id}, #{pw}, #{name}, #{mail}, #{gen}, #{ano})
	</insert>
	<insert id="addFind" parameterType="fVO" >
		<selectKey keyProperty="mno" resultType="int" order="BEFORE">
			SELECT
				MAX(mno)
			From 
				member
		</selectKey>
		INSERT INTO 
		    find(fno, mno, qno, answer) 
		VALUES( 
		    ( 
		        SELECT NVL(MAX(fno) + 1, 1001) FROM find 
		    ), 
		    #{mno}, #{qno}, #{answer}) 
	</insert>

	<update id="editMemb" parameterType="mVO">
		UPDATE
			member
		<set>
			<if test="mail != ''">mail = #{mail},</if>
			<if test="ano != 0">ano = #{ano}</if>
		</set>
		WHERE
			id = #{id}
	</update>
	<update id="delMemb" parameterType="mVO">
		UPDATE
			member
		SET
			isshow = 'N'
		WHERE
			id = #{id}
	</update>

</mapper>